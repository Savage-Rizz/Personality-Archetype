<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archetype Personality Quiz</title>
    <style>
        :root {
            --primary: #6c5ce7;
            --secondary: #a8a5e6;
            --background: #2d2d2d;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--background);
            color: white;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .section {
            display: none;
            animation: fadeIn 0.5s;
        }

        .active {
            display: block;
        }

        input[type="text"] {
            padding: 12px;
            width: 300px;
            border: 2px solid var(--primary);
            border-radius: 8px;
            font-size: 16px;
            margin: 10px 0;
            background-color: #4a4a4a;
            color: white;
        }

        button {
            background: var(--primary);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: transform 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
        }

        .question {
            background: #3a3a3a;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: #4a4a4a;
            border-radius: 5px;
            margin: 30px 0;
        }

        .progress {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 5px;
            transition: width 0.4s ease;
        }

        .result-card {
            background: #3a3a3a;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        label {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px;
            margin: 10px 0;
            background: #4a4a4a;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        label:hover {
            background: #5a5a5a;
            transform: translateX(10px);
        }

        input[type="checkbox"] {
            accent-color: var(--primary);
            min-width: 18px;
            min-height: 18px;
        }

        .archetype-details {
            margin-top: 30px;
            background: #3a3a3a;
            padding: 20px;
            border-radius: 15px;
        }

        .archetype-details h3 {
            color: var(--primary);
            border-bottom: 2px solid var(--primary);
            padding-bottom: 10px;
        }

        .archetype-details p {
            margin: 10px 0;
        }

        .archetype-details ul {
            margin: 10px 0;
            padding-left: 20px;
        }

        /* Radar Chart Styles */
        .radar-chart-container {
            margin: 30px 0;
            display: flex;
            justify-content: center;
        }

        .radar-chart {
            width: 340px; /* Increased to accommodate larger SVG */
            height: 340px; /* Increased to accommodate larger SVG */
            position: relative;
            background-color: #3a3a3a;
            border-radius: 15px;
            padding: 10px;
            box-sizing: border-box;
        }

        .radar-chart svg {
            width: 100%;
            height: 100%;
        }

        .radar-grid-circle {
            fill: none;
            stroke: #777; /* Lighter stroke for visibility */
            stroke-width: 1;
        }

        .radar-axis-line {
            stroke: #777; /* Lighter stroke for visibility */
            stroke-width: 1;
        }

        .radar-data-point {
            fill: var(--primary);
            r: 5; /* Larger points for visibility */
            stroke: white;
            stroke-width: 1.5;
        }

        .radar-data-area {
            fill: var(--primary);
            opacity: 0.5; /* Increased opacity for visibility */
            stroke: var(--primary);
            stroke-width: 2;
        }

        .radar-label {
            fill: white;
            font-size: 8px; /* Reduced font size to prevent clipping */
            font-weight: normal;
        }

        .trait-scores {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }

        .trait-score {
            background: #4a4a4a;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 14px;
        }

        .trait-score span {
            color: var(--primary);
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Landing Page -->
        <div class="section active" id="landing">
            <h1>Discover Your Archetypes</h1>
            <input type="text" id="userName" placeholder="Enter your name">
            <button onclick="startQuiz()">Start Quiz</button>
        </div>

        <!-- Quiz Section -->
        <div class="section" id="quiz">
            <div class="progress-bar">
                <div class="progress" id="progress"></div>
            </div>
            <div id="questionContainer"></div>
        </div>

        <!-- Results Section -->
        <div class="section" id="results">
            <div class="result-card">
                <h2 id="resultName"></h2>
                <div class="main-result">
                    <h3>Your Primary Personality Archetype</h3>
                    <h2 id="personalityType" style="color: var(--primary)"></h2>
                    <p id="personalityDesc"></p>
                    <div id="personalityDetails" class="archetype-details"></div>
                </div>

                <!-- Radar Chart Section -->
                <h3>Your Personality Traits</h3>
                <div class="radar-chart-container">
                    <div class="radar-chart" id="radarChartContainer">
                        <!-- SVG Radar Chart will be drawn here by JavaScript -->
                    </div>
                </div>
                <div class="trait-scores" id="traitScores"></div>

                <div class="victim-result">
                    <h4>Top 3 Victim Archetypes:</h4>
                    <ol id="victimList"></ol>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Complete Archetype Data (Includes trait mappings within options)
        const questions = [
            {
                text: "How do you handle conflict?",
                options: [
                    { text: "Avoid it", archetype: ["Caregiver", "Novice"], traits: { Trustworthiness: 1, Communication: 1 } },
                    { text: "Confront it", archetype: ["Hero", "Conqueror"], traits: { Trustworthiness: 3, Communication: 3 } },
                    { text: "Analyze it", archetype: ["Sage", "Professor"], traits: { Trustworthiness: 4, Communication: 4 } },
                    { text: "Use humor", archetype: ["Jester", "Drama Queen"], traits: { Trustworthiness: 2, Communication: 3, Humor: 5 } },
                    { text: "Seek compromise", archetype: ["Everyman", "Rescuer"], traits: { Trustworthiness: 5, Communication: 5 } }
                ]
            },
            {
                text: "What's your idea of a perfect date?",
                options: [
                    { text: "Wild adventure", archetype: ["Explorer", "Disappointed Dreamer"], traits: { Humor: 3 } },
                    { text: "Quiet night in", archetype: ["Innocent", "New Prude"], traits: {} },
                    { text: "Luxurious experience", archetype: ["Ruler", "Pampered Royal"], traits: {} },
                    { text: "Deep conversation", archetype: ["Sage", "Exotic Fetishist"], traits: { Humor: 2 } },
                    { text: "Surprising twists", archetype: ["Magician", "Crushed Star"], traits: { Humor: 4 } }
                ]
            },
            {
                text: "How do you make decisions?",
                options: [
                    { text: "Follow my gut", archetype: ["Rebel", "Reformed Rake"], traits: { Trustworthiness: 2, Discipline: 2, Carrying: 2 } },
                    { text: "Weigh pros/cons", archetype: ["Sage", "Professor"], traits: { Trustworthiness: 5, Communication: 4, Discipline: 5, Carrying: 5 } },
                    { text: "Ask for advice", archetype: ["Everyman", "Novice"], traits: { Trustworthiness: 3, Communication: 5, Supportive: 3, Carrying: 4 } },
                    { text: "Prioritize others", archetype: ["Caregiver", "Rescuer"], traits: { Trustworthiness: 4, Supportive: 5, Carrying: 4 } },
                    { text: "Chase excitement", archetype: ["Explorer", "Drama Queen"], traits: { Trustworthiness: 1, Discipline: 2, Carrying: 1 } }
                ]
            },
            {
                text: "What's your biggest fear?",
                options: [
                    { text: "Being ignored", archetype: ["Lover", "Crushed Star"], traits: {} },
                    { text: "Losing control", archetype: ["Ruler", "Aging Baby"], traits: {} },
                    { text: "Being ordinary", archetype: ["Creator", "Disappointed Dreamer"], traits: {} },
                    { text: "Betrayal", archetype: ["Hero", "Conqueror"], traits: { Trustworthiness: 5 } },
                    { text: "Loneliness", archetype: ["Everyman", "Lonely Leader"], traits: {} }
                ]
            },
            {
                text: "How do you express love?",
                options: [
                    { text: "Grand gestures", archetype: ["Lover", "Sensualist"], traits: { Trustworthiness: 2, Carrying: 3 } },
                    { text: "Quiet support", archetype: ["Caregiver", "Rescuer"], traits: { Trustworthiness: 5, Supportive: 5, Carrying: 4 } },
                    { text: "Intellectual bonding", archetype: ["Sage", "Professor"], traits: { Trustworthiness: 2, Carrying: 2 } },
                    { text: "Playful teasing", archetype: ["Jester", "Coquette"], traits: { Humor: 5, Carrying: 2 } },
                    { text: "Protectiveness", archetype: ["Hero", "Conqueror"], traits: { Trustworthiness: 4, Supportive: 4, Carrying: 5 } }
                ]
            },
            {
                text: "What attracts you most in others?",
                options: [
                    { text: "Confidence", archetype: ["Ruler", "Charismatic"], traits: {} },
                    { text: "Mystery", archetype: ["Magician", "Siren"], traits: {} },
                    { text: "Kindness", archetype: ["Caregiver", "Rescuer"], traits: {} },
                    { text: "Humor", archetype: ["Jester", "Drama Queen"], traits: { Humor: 5, Communication: 2 } },
                    { text: "Ambition", archetype: ["Hero", "Conqueror"], traits: {} }
                ]
            },
            {
                text: "How do you react to criticism?",
                options: [
                    { text: "Defensive", archetype: ["Rebel", "Reformed Rake"], traits: { Communication: 2 } },
                    { text: "Reflective", archetype: ["Sage", "Professor"], traits: { Communication: 5 } },
                    { text: "Hurt", archetype: ["Innocent", "Crushed Star"], traits: { Communication: 2 } },
                    { text: "Indifferent", archetype: ["Jester", "Roué"], traits: { Communication: 2 } },
                    { text: "Analyize it", archetype: ["Creator", "Exotic Fetishist"], traits: { Communication: 4 } }
                ]
            },
            {
                text: "What's your role in a group?",
                options: [
                    { text: "Leader", archetype: ["Ruler", "Lonely Leader"], traits: { Communication: 3, Carrying: 5 } },
                    { text: "Mediator", archetype: ["Everyman", "Rescuer"], traits: { Communication: 5, Supportive: 5, Carrying: 4 } },
                    { text: "Idea-generator", archetype: ["Creator", "Disappointed Dreamer"], traits: { Communication: 2, Carrying: 2 } },
                    { text: "Entertainer", archetype: ["Jester", "Drama Queen"], traits: { Communication: 3, Humor: 5, Carrying: 2 } },
                    { text: "Observer", archetype: ["Sage", "New Prude"], traits: { Communication: 2, Carrying: 3 } }
                ]
            },
            {
                text: "What's your guilty pleasure?",
                options: [
                    { text: "Romantic novels", archetype: ["Lover", "Idol Worshiper"], traits: {} },
                    { text: "Reality TV", archetype: ["Jester", "Drama Queen"], traits: { Humor: 5 } },
                    { text: "Luxury shopping", archetype: ["Ruler", "Pampered Royal"], traits: {} },
                    { text: "Thrill-seeking", archetype: ["Explorer", "Reformed Rake"], traits: {} },
                    { text: "Learning", archetype: ["Sage", "Professor"], traits: {} }
                ]
            },
            {
                text: "How do you handle boredom?",
                options: [
                    { text: "Seek adventure", archetype: ["Explorer", "Disappointed Dreamer"], traits: { Discipline: 2 } },
                    { text: "Daydream", archetype: ["Creator", "Crushed Star"], traits: { Discipline: 2 } },
                    { text: "Socialize", archetype: ["Lover", "Sensualist"], traits: {} },
                    { text: "Stir up drama", archetype: ["Rebel", "Drama Queen"], traits: { Discipline: 1 } },
                    { text: "Plan something", archetype: ["Ruler", "Conqueror"], traits: { Discipline: 5 } }
                ]
            },
            {
                text: "What's your biggest strength?",
                options: [
                    { text: "Empathy", archetype: ["Caregiver", "Rescuer"], traits: { Supportive: 5, Carrying: 4 } },
                    { text: "Courage", archetype: ["Hero", "Conqueror"], traits: { Carrying: 3 } },
                    { text: "Creativity", archetype: ["Creator", "Disappointed Dreamer"], traits: { Carrying: 3 } },
                    { text: "Logic", archetype: ["Sage", "Professor"], traits: { Carrying: 5 } },
                    { text: "Adaptability", archetype: ["Everyman", "Floating Gender"], traits: { Carrying: 3 } }
                ]
            },
            {
                text: "How do you recharge emotionally?",
                options: [
                    { text: "Alone time", archetype: ["Innocent", "New Prude"], traits: { Carrying: 4 } },
                    { text: "Socializing", archetype: ["Lover", "Sensualist"], traits: { Carrying: 3 } },
                    { text: "New experiences", archetype: ["Explorer", "Exotic Fetishist"], traits: { Carrying: 2 } },
                    { text: "Creative projects", archetype: ["Creator", "Disappointed Dreamer"], traits: { Carrying: 2 } },
                    { text: "Routine", archetype: ["Ruler", "Pampered Royal"], traits: { Carrying: 5 } }
                ]
            },
            {
                text: "What's your default mood?",
                options: [
                    { text: "Optimistic", archetype: ["Innocent", "Crushed Star"], traits: {} },
                    { text: "Analytical", archetype: ["Sage", "Professor"], traits: {} },
                    { text: "Playful", archetype: ["Jester", "Drama Queen"], traits: { Humor: 5 } },
                    { text: "Restless", archetype: ["Explorer", "Reformed Rake"], traits: {} },
                    { text: "Protective", archetype: ["Hero", "Conqueror"], traits: {} }
                ]
            },
            {
                text: "What's your approach to rules?",
                options: [
                    { text: "Follow them", archetype: ["Innocent", "New Prude"], traits: { Trustworthiness: 5, Discipline: 5, Carrying: 5 } },
                    { text: "Bend them", archetype: ["Rebel", "Reformed Rake"], traits: { Trustworthiness: 2, Discipline: 1, Carrying: 2 } },
                    { text: "Ignore them", archetype: ["Outlaw", "Roué"], traits: { Trustworthiness: 1, Discipline: 1, Carrying: 2 } },
                    { text: "Improve them", archetype: ["Creator", "Disappointed Dreamer"], traits: { Discipline: 3, Carrying: 3 } },
                    { text: "Enforce them", archetype: ["Ruler", "Lonely Leader"], traits: { Trustworthiness: 4, Discipline: 5, Carrying: 4 } }
                ]
            },
            {
                text: "What do you value most in a partner?",
                options: [
                    { text: "Loyalty", archetype: ["Hero", "Conqueror"], traits: { Trustworthiness: 5, Supportive: 4 } },
                    { text: "Intelligence", archetype: ["Sage", "Professor"], traits: {} },
                    { text: "Spontaneity", archetype: ["Explorer", "Disappointed Dreamer"], traits: {} },
                    { text: "Affection", archetype: ["Lover", "Sensualist"], traits: { Supportive: 4 } },
                    { text: "Ambition", archetype: ["Ruler", "Pampered Royal"], traits: {} }
                ]
            },
            {
                text: "How do you handle failure?",
                options: [
                    { text: "Blame others", archetype: ["Rebel", "Reformed Rake"], traits: { Discipline: 2, Carrying: 2 } },
                    { text: "Learn from it", archetype: ["Sage", "Professor"], traits: { Discipline: 4, Carrying: 4 } },
                    { text: "Hide it", archetype: ["Innocent", "New Prude"], traits: { Discipline: 2, Carrying: 2 } },
                    { text: "Laugh it off", archetype: ["Jester", "Drama Queen"], traits: { Discipline: 2, Humor: 5, Carrying: 2 } },
                    { text: "Try harder", archetype: ["Hero", "Conqueror"], traits: { Discipline: 5, Carrying: 5 } }
                ]
            },
            {
                text: "What's your favorite genre?",
                options: [
                    { text: "Fantasy", archetype: ["Magician", "Disappointed Dreamer"], traits: {} },
                    { text: "Romance", archetype: ["Lover", "Idol Worshiper"], traits: {} },
                    { text: "Mystery", archetype: ["Sage", "Exotic Fetishist"], traits: {} },
                    { text: "Comedy", archetype: ["Jester", "Drama Queen"], traits: { Humor: 5 } },
                    { text: "History", archetype: ["Ruler", "Lonely Leader"], traits: {} }
                ]
            },
            {
                text: "What's your life motto?",
                options: [
                    { text: "Carpe Diem", archetype: ["Explorer", "Reformed Rake"], traits: {} },
                    { text: "Know thyself", archetype: ["Sage", "Professor"], traits: {} },
                    { text: "Live and let live", archetype: ["Everyman", "Rescuer"], traits: {} },
                    { text: "Rules are meant to be broken", archetype: ["Rebel", "Roué"], traits: {} },
                    { text: "Power is everything", archetype: ["Ruler", "Pampered Royal"], traits: {} }
                ]
            },
            {
                text: "How do you respond to flirting?",
                options: [
                    { text: "Play along", archetype: ["Jester", "Coquette"], traits: { Communication: 4, Humor: 5 } },
                    { text: "Analyze intentions", archetype: ["Sage", "Professor"], traits: { Communication: 5 } },
                    { text: "Shy away", archetype: ["Innocent", "New Prude"], traits: { Communication: 2 } },
                    { text: "Enjoy the chase", archetype: ["Explorer", "Reformed Rake"], traits: { Communication: 2 } },
                    { text: "Take charge", archetype: ["Hero", "Conqueror"], traits: { Communication: 3 } }
                ]
            },
            {
                text: "What defines your identity?",
                options: [
                    { text: "Relationships", archetype: ["Lover", "Sensualist"], traits: {} },
                    { text: "Achievements", archetype: ["Hero", "Crushed Star"], traits: { Discipline: 5 } },
                    { text: "Knowledge", archetype: ["Sage", "Professor"], traits: {} },
                    { text: "Creativity", archetype: ["Creator", "Disappointed Dreamer"], traits: {} },
                    { text: "Status", archetype: ["Ruler", "Pampered Royal"], traits: { Discipline: 3 } }
                ]
            }
        ];

        const personalityArchetypes = {
            "Innocent": {
                description: "Optimistic and trusting, you believe in the good of people.",
                category: "Freedom",
                details: {
                    motto: "Free to be you and me",
                    goal: "To be happy",
                    fear: "Doing something wrong or bad",
                    traits: ["Optimistic", "Honest", "Pure", "Naive"],
                    examples: ["Dorothy (The Wizard of Oz)", "Forrest Gump"]
                }
            },
            "Everyman": {
                description: "Relatable and down-to-earth, you value belonging.",
                category: "Social",
                details: {
                    motto: "All men and women are created equal",
                    goal: "To belong, fit in",
                    fear: "Standing out, being rejected",
                    traits: ["Friendly", "Empathetic", "Grounded", "Humble"],
                    examples: ["Bilbo Baggins", "Samwise Gamgee"]
                }
            },
            "Hero": {
                description: "Courageous and determined, you thrive on challenges.",
                category: "Ego",
                details: {
                    motto: "Where there's a will, there's a way",
                    goal: "To prove worth through courage",
                    fear: "Weakness, failure",
                    traits: ["Courageous", "Determined", "Honorable", "Competitive"],
                    examples: ["Superman", "Wonder Woman"]
                }
            },
            "Caregiver": {
                description: "Nurturing and protective, you prioritize others' needs.",
                category: "Order",
                details: {
                    motto: "Love your neighbor as yourself",
                    goal: "To help and care for others",
                    fear: "Selfishness, ingratitude",
                    traits: ["Compassionate", "Nurturing", "Generous"],
                    examples: ["Marge Simpson", "Mary Poppins"]
                }
            },
            "Explorer": {
                description: "Adventurous and curious, you crave new experiences.",
                category: "Freedom",
                details: {
                    motto: "Don't fence me in",
                    goal: "To experience a better, more authentic life",
                    fear: "Conformity",
                    traits: ["Restless", "Adventurous", "Independent"],
                    examples: ["Indiana Jones", "Moana"]
                }
            },
            "Rebel": {
                description: "Rule-breaking and revolutionary, you challenge norms.",
                category: "Ego",
                details: {
                    motto: "Rules are made to be broken",
                    goal: "To overturn what isn't working",
                    fear: "Powerlessness",
                    traits: ["Radical", "Disruptive", "Brave", "Free-spirited"],
                    examples: ["V (V for Vendetta)", "James Dean"]
                }
            },
            "Lover": {
                description: "Passionate and romantic, you seek deep connections.",
                category: "Social",
                details: {
                    motto: "I only have eyes for you",
                    goal: "To be in a relationship with people, work, or surroundings",
                    fear: "Being alone",
                    traits: ["Passionate", "Romantic", "Committed"],
                    examples: ["Romeo and Juliet", "Jack (Titanic)"]
                }
            },
            "Creator": {
                description: "Innovative and visionary, you express through creation.",
                category: "Order",
                details: {
                    motto: "If you can imagine it, it can be done",
                    goal: "To create something of enduring value",
                    fear: "Mediocrity",
                    traits: ["Imaginative", "Artistic", "Driven", "Innovative"],
                    examples: ["Tony Stark", "Steve Jobs (in storytelling)"]
                }
            },
            "Jester": {
                description: "Playful and humorous, you bring joy to others.",
                category: "Social",
                details: {
                    motto: "You only live once",
                    goal: "To live in the moment with full enjoyment",
                    fear: "Boredom or being boring",
                    traits: ["Playful", "Humorous", "Spontaneous", "Fun-loving"],
                    examples: ["Jack Sparrow", "The Mask"]
                }
            },
            "Sage": {
                description: "Wise and analytical, you seek knowledge and truth.",
                category: "Freedom",
                details: {
                    motto: "The truth will set you free",
                    goal: "To find truth and understanding",
                    fear: "Ignorance, being misled",
                    traits: ["Wise", "Analytical", "Reflective", "Articulate"],
                    examples: ["Yoda", "Gandalf"]
                }
            },
            "Magician": {
                description: "Transformative and charismatic, you create change.",
                category: "Ego",
                details: {
                    motto: "I make things happen",
                    goal: "To transform situations or influence change",
                    fear: "Unintended negative consequences",
                    traits: ["Visionary", "Powerful", "Charismatic"],
                    examples: ["Dumbledore", "Merlin"]
                }
            },
            "Ruler": {
                description: "Authoritative and responsible, you lead with control.",
                category: "Order",
                details: {
                    motto: "Power isn't everything, it's the only thing",
                    goal: "To create a successful and prosperous kingdom",
                    fear: "Chaos, being overthrown",
                    traits: ["Responsible", "Organized", "Authoritative"],
                    examples: ["Mufasa", "Tywin Lannister"]
                }
            }
        };

        const victimArchetypes = {
            "Reformed Rake": { description: "Formerly wild, now craving stability but easily tempted." },
            "Disappointed Dreamer": { description: "Yearns for escapism from a mundane life." },
            "Pampered Royal": { description: "Spoiled and entitled, needs constant attention." },
            "New Prude": { description: "Repressed but secretly curious about transgression." },
            "Crushed Star": { description: "Once admired, now insecure and validation-seeking." },
            "Novice": { description: "Inexperienced and eager to learn." },
            "Conqueror": { description: "Thrives on challenges and dominance." },
            "Exotic Fetishist": { description: "Obsessed with the unfamiliar and unusual." },
            "Drama Queen": { description: "Loves emotional turbulence and chaos." },
            "Professor": { description: "Overanalyzes, needs intellectual stimulation." },
            "Beauty": { description: "Relies on physical allure, fears aging." },
            "Aging Baby": { description: "Clings to youth and dependency." },
            "Rescuer": { description: "Fixated on saving others, has savior complex." },
            "Roué": { description: "Cynical and jaded, seeks constant pleasure." },
            "Idol Worshiper": { description: "Obsessed with idealizing others." },
            "Sensualist": { description: "Prioritizes physical pleasure above all." },
            "Lonely Leader": { description: "Powerful but isolated, seeks connection." },
            "Floating Gender": { description: "Rejects traditional gender roles." }
        };

        // Trait Scoring (Standardized names)
        const traitNames = ["Trustworthiness", "Carrying", "Communication", "Humor", "Supportive", "Discipline"];

        // Quiz Logic
        let currentQuestion = 0;
        let userName = "";
        let scores = { personality: {}, victim: {}, traits: {} };
        let totalRawTraitScores = {};
        let questionContributionsCount = {};

        function initScores() {
            Object.keys(personalityArchetypes).forEach(arch => scores.personality[arch] = 0);
            Object.keys(victimArchetypes).forEach(arch => scores.victim[arch] = 0);

            totalRawTraitScores = {};
            questionContributionsCount = {};
            traitNames.forEach(trait => {
                totalRawTraitScores[trait] = 0;
                questionContributionsCount[trait] = 0;
            });
        }

        function startQuiz() {
            userName = document.getElementById('userName').value.trim();
            if (!userName) return alert('Please enter your name!');

            initScores();
            currentQuestion = 0;
            document.getElementById('landing').classList.remove('active');
            document.getElementById('quiz').classList.add('active');
            showQuestion();
        }

        function showQuestion() {
            const question = questions[currentQuestion];
            let html = `<div class="question"><h3>${question.text}</h3>`;
            question.options.forEach((opt, idx) => {
                html += `<label>
                    <input type="checkbox" name="answer" value="${idx}">
                    ${opt.text}
                </label>`;
            });
            html += `<button onclick="nextQuestion()">Next</button></div>`;
            document.getElementById('questionContainer').innerHTML = html;
            updateProgress();
        }

        function updateProgress() {
            const progress = ((currentQuestion + 1) / questions.length) * 100;
            document.getElementById('progress').style.width = `${progress}%`;
        }

        function nextQuestion() {
            const selected = document.querySelectorAll('input[name="answer"]:checked');
            if (selected.length === 0) return alert('Please select at least one answer!');

            const currentQuestionEarnedScores = {};
            traitNames.forEach(trait => {
                currentQuestionEarnedScores[trait] = 0;
            });

            selected.forEach(checkbox => {
                const answerIndex = parseInt(checkbox.value, 10);
                const answer = questions[currentQuestion].options[answerIndex];

                // Score Archetypes
                if (answer.archetype) {
                    answer.archetype.forEach(arch => {
                        if (scores.personality[arch] !== undefined) scores.personality[arch]++;
                        if (scores.victim[arch] !== undefined) scores.victim[arch]++;
                    });
                }

                // Accumulate raw trait scores
                if (answer.traits) {
                    for (const trait in answer.traits) {
                        if (currentQuestionEarnedScores[trait] !== undefined) {
                            currentQuestionEarnedScores[trait] += answer.traits[trait];
                        }
                    }
                }
            });

            // Update total trait scores and count contributions
            traitNames.forEach(trait => {
                let traitExistsInQuestion = false;
                questions[currentQuestion].options.forEach(option => {
                    if (option.traits && option.traits[trait] !== undefined) {
                        traitExistsInQuestion = true;
                    }
                });

                if (traitExistsInQuestion) {
                    if (selected.length > 1 && currentQuestionEarnedScores[trait] > 0) {
                        totalRawTraitScores[trait] += currentQuestionEarnedScores[trait] / selected.length;
                    } else {
                        totalRawTraitScores[trait] += currentQuestionEarnedScores[trait];
                    }
                    questionContributionsCount[trait]++;
                }
            });

            currentQuestion++;
            if (currentQuestion < questions.length) {
                showQuestion();
            } else {
                showResults();
            }
        }

        function calculateTraitScores() {
            const normalizedScores = {};
            traitNames.forEach(trait => {
                const totalEarned = totalRawTraitScores[trait] || 0;
                const numContributions = questionContributionsCount[trait] || 1; // Avoid division by zero
                let normalizedScore = 0;

                // Normalize based on max possible score per question (assuming 5)
                if (numContributions > 0) {
                    const averageEarned = totalEarned / numContributions;
                    normalizedScore = (averageEarned / 5) * 100; // Max score per question is 5
                }

                normalizedScores[trait] = Math.min(100, Math.max(0, Math.round(normalizedScore))); // Clamp between 0 and 100
            });
            return normalizedScores;
        }

        function showResults() {
            const personalityResult = Object.entries(scores.personality).sort((a, b) => b[1] - a[1])[0];
            const victimResults = Object.entries(scores.victim).sort((a, b) => b[1] - a[1]).slice(0, 3);

            document.getElementById('resultName').textContent = `${userName}'s Results`;
            document.getElementById('personalityType').textContent = personalityResult[0];
            document.getElementById('personalityDesc').textContent = personalityArchetypes[personalityResult[0]].description;

            // Display detailed archetype information
            const details = personalityArchetypes[personalityResult[0]].details;
            let detailsHTML = `
                <h3>${personalityResult[0]} Archetype Details</h3>
                <p><strong>Motto:</strong> ${details.motto}</p>
                <p><strong>Goal:</strong> ${details.goal}</p>
                <p><strong>Fear:</strong> ${details.fear}</p>
                <p><strong>Key Traits:</strong></p>
                <ul>${details.traits.map(trait => `<li>${trait}</li>`).join('')}</ul>
                <p><strong>Examples:</strong> ${details.examples.join(', ')}</p>
            `;
            document.getElementById('personalityDetails').innerHTML = detailsHTML;

            // Display victim archetypes
            const victimList = document.getElementById('victimList');
            victimList.innerHTML = victimResults.map(([arch]) => `
                <li><strong>${arch}</strong>: ${victimArchetypes[arch]?.description || 'No description available.'}</li>
            `).join('');

            // Calculate and display normalized trait scores
            const normalizedTraits = calculateTraitScores();
            console.log("Normalized Trait Scores:", normalizedTraits);

            createRadarChart(normalizedTraits);

            // Display trait scores
            const traitScoresContainer = document.getElementById('traitScores');
            traitScoresContainer.innerHTML = '';
            for (const trait in normalizedTraits) {
                const scoreDiv = document.createElement('div');
                scoreDiv.className = 'trait-score';
                scoreDiv.innerHTML = `${trait}: <span>${normalizedTraits[trait]}</span>`;
                traitScoresContainer.appendChild(scoreDiv);
            }

            document.getElementById('quiz').classList.remove('active');
            document.getElementById('results').classList.add('active');
        }

        function createRadarChart(data) {
            const container = document.getElementById('radarChartContainer');
            container.innerHTML = ''; // Clear previous chart

            const traits = Object.keys(data);
            const values = Object.values(data).map(v => Math.max(0, v)); // Ensure no negative values
            const numTraits = traits.length;
            const width = 320; // Increased width to accommodate labels
            const height = 320; // Increased height to accommodate labels
            const centerX = width / 2;
            const centerY = height / 2;
            const radius = Math.min(width, height) * 0.35; // Reduced radius for label space

            const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
            svg.setAttribute("width", width);
            svg.setAttribute("height", height);
            svg.setAttribute("viewBox", `-20 -20 ${width + 40} ${height + 40}`); // Expanded viewBox to prevent clipping

            // Draw grid circles (20%, 40%, 60%, 80%, 100%)
            for (let i = 1; i <= 5; i++) {
                const r = radius * (i / 5);
                const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                circle.setAttribute("cx", centerX);
                circle.setAttribute("cy", centerY);
                circle.setAttribute("r", r);
                circle.classList.add("radar-grid-circle");
                svg.appendChild(circle);
            }

            // Draw axes and labels
            traits.forEach((trait, i) => {
                const angle = (i / numTraits) * 2 * Math.PI - Math.PI / 2;
                const xEnd = centerX + Math.cos(angle) * radius;
                const yEnd = centerY + Math.sin(angle) * radius;

                // Axis line
                const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
                line.setAttribute("x1", centerX);
                line.setAttribute("y1", centerY);
                line.setAttribute("x2", xEnd);
                line.setAttribute("y2", yEnd);
                line.classList.add("radar-axis-line");
                svg.appendChild(line);

                // Label
                const labelDistance = radius * 1.3; // Increased distance to push labels out
                let xLabel = centerX + Math.cos(angle) * labelDistance;
                let yLabel = centerY + Math.sin(angle) * labelDistance;

                // Adjust label positions
                const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
                text.setAttribute("x", xLabel);
                text.setAttribute("y", yLabel);
                text.setAttribute("text-anchor", Math.cos(angle) > 0.5 ? "start" : Math.cos(angle) < -0.5 ? "end" : "middle");
                text.setAttribute("dominant-baseline", Math.sin(angle) > 0.5 ? "hanging" : Math.sin(angle) < -0.5 ? "text-bottom" : "middle");
                text.classList.add("radar-label");
                text.textContent = trait;
                svg.appendChild(text);
            });

            // Draw data polygon
            let points = "";
            values.forEach((value, i) => {
                const angle = (i / numTraits) * 2 * Math.PI - Math.PI / 2;
                const r = radius * (value / 100);
                const x = centerX + Math.cos(angle) * r;
                const y = centerY + Math.sin(angle) * r;
                points += `${x},${y} `;
            });
            const polygon = document.createElementNS("http://www.w3.org/2000/svg", "polygon");
            polygon.setAttribute("points", points.trim());
            polygon.classList.add("radar-data-area");
            svg.appendChild(polygon);

            // Draw data points
            values.forEach((value, i) => {
                const angle = (i / numTraits) * 2 * Math.PI - Math.PI / 2;
                const r = radius * (value / 100);
                const x = centerX + Math.cos(angle) * r;
                const y = centerY + Math.sin(angle) * r;
                const point = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                point.setAttribute("cx", x);
                point.setAttribute("cy", y);
                point.classList.add("radar-data-point");
                svg.appendChild(point);
            });

            container.appendChild(svg);
            console.log("Radar chart rendered with data:", data);
        }
    </script>
</body>
</html>
